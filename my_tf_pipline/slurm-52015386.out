Loading rhel8/default-amp
  Loading requirement: dot rhel8/slurm singularity/current rhel8/global
    cuda/11.4 openmpi/4.1.1/gcc-9.4.0-epagguv
Changed directory to /rds/user/hpczeji1/hpc-work/Codebase/AllAbout_DeepLearning/Tutorial/my_tf_pipline.

JobID: 52015386
======
Time: Wed 22 Dec 13:29:16 GMT 2021
Running on master node: gpu-q-8
Current directory: /rds/user/hpczeji1/hpc-work/Codebase/AllAbout_DeepLearning/Tutorial/my_tf_pipline

Nodes allocated:
================
gpu-q-8

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
python complexity_cal.py 

2021-12-22 13:29:18.257799: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/python-3.6.2-me5fseeigjqt7izoku6haq3cevm6pjfi/lib:/usr/local/Cluster-Apps/cudnn/8.0_cuda-11.1/lib64:/usr/local/software/cuda/11.0/lib64:/usr/local/software/cuda/11.0/lib:/usr/local/software/cuda/11.0/nvvm/lib64:/usr/local/software/spack/spack-rhel8-20210927/opt/spack/linux-centos8-zen2/gcc-9.4.0/openmpi-4.1.1-epagguvqfrwuokz2ftiyzbxibae5afnn/lib:/usr/local/software/cuda/11.4/lib64:/usr/local/software/cuda/11.4/lib:/usr/local/software/cuda/11.4/nvvm/lib64:/usr/local/software/global-rhel8/lib:/usr/local/software/slurm/current-rhel8/lib
2021-12-22 13:29:18.257861: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2021-12-22 13:29:22.766616: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-12-22 13:29:22.827576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:c1:00.0 name: NVIDIA A100-SXM-80GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 79.35GiB deviceMemoryBandwidth: 1.85TiB/s
2021-12-22 13:29:22.827813: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/python-3.6.2-me5fseeigjqt7izoku6haq3cevm6pjfi/lib:/usr/local/Cluster-Apps/cudnn/8.0_cuda-11.1/lib64:/usr/local/software/cuda/11.0/lib64:/usr/local/software/cuda/11.0/lib:/usr/local/software/cuda/11.0/nvvm/lib64:/usr/local/software/spack/spack-rhel8-20210927/opt/spack/linux-centos8-zen2/gcc-9.4.0/openmpi-4.1.1-epagguvqfrwuokz2ftiyzbxibae5afnn/lib:/usr/local/software/cuda/11.4/lib64:/usr/local/software/cuda/11.4/lib:/usr/local/software/cuda/11.4/nvvm/lib64:/usr/local/software/global-rhel8/lib:/usr/local/software/slurm/current-rhel8/lib
2021-12-22 13:29:22.829526: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/python-3.6.2-me5fseeigjqt7izoku6haq3cevm6pjfi/lib:/usr/local/Cluster-Apps/cudnn/8.0_cuda-11.1/lib64:/usr/local/software/cuda/11.0/lib64:/usr/local/software/cuda/11.0/lib:/usr/local/software/cuda/11.0/nvvm/lib64:/usr/local/software/spack/spack-rhel8-20210927/opt/spack/linux-centos8-zen2/gcc-9.4.0/openmpi-4.1.1-epagguvqfrwuokz2ftiyzbxibae5afnn/lib:/usr/local/software/cuda/11.4/lib64:/usr/local/software/cuda/11.4/lib:/usr/local/software/cuda/11.4/nvvm/lib64:/usr/local/software/global-rhel8/lib:/usr/local/software/slurm/current-rhel8/lib
2021-12-22 13:29:22.833144: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-22 13:29:22.835194: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-22 13:29:22.839782: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-22 13:29:22.841228: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/python-3.6.2-me5fseeigjqt7izoku6haq3cevm6pjfi/lib:/usr/local/Cluster-Apps/cudnn/8.0_cuda-11.1/lib64:/usr/local/software/cuda/11.0/lib64:/usr/local/software/cuda/11.0/lib:/usr/local/software/cuda/11.0/nvvm/lib64:/usr/local/software/spack/spack-rhel8-20210927/opt/spack/linux-centos8-zen2/gcc-9.4.0/openmpi-4.1.1-epagguvqfrwuokz2ftiyzbxibae5afnn/lib:/usr/local/software/cuda/11.4/lib64:/usr/local/software/cuda/11.4/lib:/usr/local/software/cuda/11.4/nvvm/lib64:/usr/local/software/global-rhel8/lib:/usr/local/software/slurm/current-rhel8/lib
2021-12-22 13:29:22.842498: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/python-3.6.2-me5fseeigjqt7izoku6haq3cevm6pjfi/lib:/usr/local/Cluster-Apps/cudnn/8.0_cuda-11.1/lib64:/usr/local/software/cuda/11.0/lib64:/usr/local/software/cuda/11.0/lib:/usr/local/software/cuda/11.0/nvvm/lib64:/usr/local/software/spack/spack-rhel8-20210927/opt/spack/linux-centos8-zen2/gcc-9.4.0/openmpi-4.1.1-epagguvqfrwuokz2ftiyzbxibae5afnn/lib:/usr/local/software/cuda/11.4/lib64:/usr/local/software/cuda/11.4/lib:/usr/local/software/cuda/11.4/nvvm/lib64:/usr/local/software/global-rhel8/lib:/usr/local/software/slurm/current-rhel8/lib
2021-12-22 13:29:22.842521: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-12-22 13:29:22.842959: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-22 13:29:22.853320: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2445500000 Hz
2021-12-22 13:29:22.854980: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56065f355700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-12-22 13:29:22.855009: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-12-22 13:29:22.856537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-22 13:29:22.856558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Model: "vgg16"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 224, 224, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 224, 224, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 224, 224, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 112, 112, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 112, 112, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 112, 112, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 56, 56, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 56, 56, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 28, 28, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 28, 28, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 14, 14, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 7, 7, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 25088)             0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              102764544 
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
predictions (Dense)          (None, 1000)              4097000   
=================================================================
Total params: 138,357,544
Trainable params: 138,357,544
Non-trainable params: 0
_________________________________________________________________
[<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x151a2cfc69e8>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519dfa7a828>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df77d828>, <tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x1519df77dc18>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df5398d0>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df553780>, <tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x1519df5537f0>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df55b390>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df55bf28>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df55f630>, <tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x1519df56c780>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519df56c9e8>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519dc0ef860>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519dc0ef8d0>, <tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x1519dc0f8860>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519dc0fd080>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519dc0fdeb8>, <tensorflow.python.keras.layers.convolutional.Conv2D object at 0x1519dc1062b0>, <tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x1519dc106ba8>, <tensorflow.python.keras.layers.core.Flatten object at 0x1519dc10fa20>, <tensorflow.python.keras.layers.core.Dense object at 0x1519dc118240>, <tensorflow.python.keras.layers.core.Dense object at 0x1519dc118518>, <tensorflow.python.keras.layers.core.Dense object at 0x1519dc118a90>]
23
Caculating faces ...
Caculating animals ...
Caculating places ...
Caculating objects ...
